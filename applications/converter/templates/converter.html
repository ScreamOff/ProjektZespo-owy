{% extends 'base.html' %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/converter.css') }}">

<h2>Konwerter jednostek</h2>
<div class="converter-box">
    <form method="POST">
        <label for="category">Kategoria:</label>
        <select name="category" id="category" required>
            {% for cat in categories %}
                <option value="{{ cat }}">{{ cat.capitalize() }}</option>
            {% endfor %}
        </select>

        <label for="value">Wartość:</label>
        <input type="number" step="any" name="value" required>

        <label for="from_unit">Z:</label>
        <select name="from_unit" id="from_unit" required></select>

        <label for="to_unit">Na:</label>
        <select name="to_unit" id="to_unit" required></select>

        <button type="submit">Konwertuj</button>
    </form>

    {% if result %}
        <div class="result-box">
            <strong>Wynik:</strong> {{ result }}
        </div>
    {% endif %}
</div>

<script>
    const units = {
        length: ['m', 'km', 'cm', 'mm'],
        mass: ['kg', 'g', 'mg', 't'],
        temperature: ['C', 'F', 'K'],
        time: ['s', 'min', 'h', 'd']
    };

    const categorySelect = document.getElementById('category');
    const fromUnitSelect = document.getElementById('from_unit');
    const toUnitSelect = document.getElementById('to_unit');

    function populateUnits(category) {
        const unitList = units[category] || [];
        fromUnitSelect.innerHTML = '';
        toUnitSelect.innerHTML = '';
        unitList.forEach(unit => {
            fromUnitSelect.innerHTML += `<option value="${unit}">${unit}</option>`;
            toUnitSelect.innerHTML += `<option value="${unit}">${unit}</option>`;
        });
    }

    categorySelect.addEventListener('change', (e) => {
        populateUnits(e.target.value);
    });

    // Initialize on page load
    populateUnits(categorySelect.value);
</script>
{% endblock %}
